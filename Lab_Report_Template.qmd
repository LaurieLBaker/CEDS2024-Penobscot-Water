---
title: "Water Quality Lab Report Template"
format: html
editor: visual
execute:
  echo: false
  warning: false
---

```{r install.packages, include=FALSE}
library(tidyverse)
library(quarto)
library(dplyr)
library(devtools)
library(readr)
library(gt) #for tables
library(stringr)
library(htmltools)
library(lubridate)
```

```{r load_data}
data2018 <- readRDS("data/PINCommEngData (2).RData")
```

## Lab Report Header {.smaller}

### Collector: JRP

Run Date: **2018-09-19** Run: **Passadumkeag**

```{r}

data2018$SampleDatetime <- (as.POSIXct(data2018$SampleDatetime, format = "%m/%d/%Y %H:%M:%S"))
data2018$LabAnalysisDatetime <- (as.POSIXct(data2018$LabAnalysisDatetime, format = "%m/%d/%Y %H:%M:%S"))

data2018 %>%
  filter(SiteVisitID == "JanS5-2018925102747") %>%
  select(SiteCode, SampleDatetime, ResultValue, QCType, ResultFlag_ID, IncubationLength, LabAnalysisDatetime) %>%
  mutate(HoldTime = seconds_to_period(as.double(difftime(lubridate::ymd_hms(LabAnalysisDatetime),
                       lubridate::ymd_hms(SampleDatetime),
                       units = "secs"), na.rm = TRUE)
                       )) %>%
  distinct() %>% 
  gt() %>%
  cols_align(align = "center") %>%
   tab_style(
    style = cell_borders(
      sides = c("all"),
      color = "black",
      weight = px(1),
      style = "solid"),
    locations = list(cells_body(), cells_column_labels()))

```

```{r}
#c <- data2018 %>%
#  filter(Collector == "JRP", RunCode == "Passadumkeag", #RunDate == "2018-09-19")

#data2018 %>%
#  mutate(
 #   Constituents = case_when(
 #     Constituents == "Msmt" ~ Const,
#      TRUE ~ Constituents
#    ),
 #   ResultValue = coalesce(Result, ResultValue)) %>%
 # filter(Collector == "JRP", RunCode == "Passadumkeag", #RunDate == "2018-09-19") %>%
#  select(SiteCode, SiteVisitStartTime, Constituents, ResultValue, QCType, IncubationLength, LabAnalysisDatetime, SampleDatetime) %>%
 # gt()
```
